// ============ COURSE TYPES ============
export interface Course {
  uid: string;
  title: string;
  description: string;
  level: string;
  created_by: string;
  created_at: string;
}

export interface CourseWithProgress extends Course {
  totalModules: number;
  totalLessons: number;
  completedLessons: number;
  progress: number;
  isEnrolled: boolean;
}

export interface CourseEnrollment {
  uid: string;
  user_uid: string;
  course_uid: string;
  enrolled_at: string;
}

// ============ MODULE TYPES ============
export interface Module {
  uid: string;
  course_uid: string;
  title: string;
  description: string;
  order_index: number;
  created_at: string;
}

export interface ModuleWithProgress extends Module {
  lessons: LessonWithProgress[];
  labs: Lab[];
  progress: number;
}

// ============ LESSON TYPES ============
export interface Lesson {
  uid: string;
  module_uid: string;
  title: string;
  content: string;
  lesson_type: 'theory' | 'exercise' | 'summary';
  order_index: number;
  created_at: string;
}

export interface LessonWithProgress extends Lesson {
  topicsCount: number;
  subtopicsCount: number;
  completedSubtopics: number;
  progress: number;
  hasQuiz: boolean;
  quizScore: number | null;
}

// ============ TOPIC & SUBTOPIC TYPES ============
export interface Topic {
  uid: string;
  lesson_uid: string;
  title: string;
  description: string;
  page_number: number;
  order_index: number;
  created_at: string;
}

export interface Subtopic {
  uid: string;
  topic_uid: string;
  title: string;
  content: string;
  order_index: number;
  created_at: string;
}

export interface SubtopicWithProgress extends Subtopic {
  isCompleted: boolean;
  hasAnswer: boolean;
  userProgress: SubtopicProgress | null;
}

export interface SubtopicProgress {
  uid: string;
  student_uid: string;
  subtopic_uid: string;
  is_completed: boolean;
  completed_at: string | null;
  user_output: string;
  is_correct: boolean;
  attempt_count: number;
  last_attempted_at: string | null;
}

// ============ ANSWER TYPES ============
export interface Answer {
  uid: string;
  subtopic_uid: string;
  expected_output: string;
  check_type: 'exact' | 'contains' | 'regex' | 'custom';
  case_sensitive: boolean;
  trim_whitespace: boolean;
  explanation: string;
  hints: string;
  created_at: string;
  updated_at: string;
}

export interface SubmitAnswerRequest {
  userOutput: string;
}

export interface SubmitAnswerResponse {
  isCorrect: boolean;
  expectedOutput: string;
  explanation: string;
  hints: string;
  progress: SubtopicProgress;
}

// ============ QUIZ TYPES ============
export interface Quiz {
  uid: string;
  lesson_uid: string;
  title: string;
  description: string;
  total_questions: number;
  created_at: string;
}

export interface QuizQuestion {
  uid: string;
  quiz_uid: string;
  question_text: string;
  question_type: 'single_choice' | 'multiple_choice' | 'true_false' | 'text';
  order_index: number;
  created_at: string;
}

export interface QuizAnswer {
  uid: string;
  question_uid: string;
  answer_text: string;
  is_correct: boolean;
  created_at: string;
}

export interface QuizSubmission {
  uid: string;
  quiz_uid: string;
  student_uid: string;
  score: number;
  submitted_at: string;
}

export interface QuizSubmissionAnswer {
  uid: string;
  submission_uid: string;
  question_uid: string;
  selected_answer_uid: string;
  is_correct: boolean;
}

export interface SubmitQuizRequest {
  answers: Array<{
    questionId: string;
    selectedAnswerId: string;
  }>;
}

export interface SubmitQuizResponse {
  submission: QuizSubmission;
  score: number;
  totalQuestions: number;
  correctAnswers: number;
  details: Array<{
    questionId: string;
    isCorrect: boolean;
    correctAnswerId: string;
  }>;
}

// ============ LAB TYPES ============
export interface Lab {
  uid: string;
  module_uid: string;
  title: string;
  description: string;
  lab_type: 'single_vm' | 'network_vm' | 'external';
  is_required: boolean;
  order_index: number;
  created_at: string;
}

export interface LabComponent {
  uid: string;
  lab_uid: string;
  component_name: string;
  component_type: 'attacker_vm' | 'target_vm' | 'tool' | 'network_device';
  os_info: string;
  access_details: string;
  is_vulnerable: boolean;
  order_index: number;
  created_at: string;
}

export interface LabWithComponents extends Lab {
  components: LabComponent[];
}

// ============ LEARNING CONTENT TYPES ============
export interface LearningContent {
  lesson: Lesson;
  content: Array<{
    topic: Topic;
    subtopics: SubtopicWithProgress[];
  }>;
  quiz: Quiz | null;
  navigation: {
    prevLesson: { id: string; title: string } | null;
    nextLesson: { id: string; title: string } | null;
    currentModule: { id: string; title: string };
  };
}

// ============ PROGRESS TYPES ============
export interface StudentProgress {
  totalCourses: number;
  enrolledCourses: number;
  completedCourses: number;
  totalLessons: number;
  completedLessons: number;
  totalQuizzes: number;
  completedQuizzes: number;
  totalLabs: number;
  completedLabs: number;
  overallProgress: number;
}

export interface CourseProgress {
  course: Course;
  modules: Array<{
    module: Module;
    lessonsProgress: Array<{
      lesson: Lesson;
      subtopicsCompleted: number;
      subtopicsTotal: number;
      quizScore: number | null;
    }>;
    labsProgress: Array<{
      lab: Lab;
      isCompleted: boolean;
    }>;
    moduleProgress: number;
  }>;
  courseProgress: number;
}

// ============ API RESPONSE TYPES ============
export interface ApiResponse<T> {
  success: boolean;
  data: T;
  message?: string;
}

export interface PaginatedResponse<T> {
  success: boolean;
  data: T[];
  pagination: {
    page: number;
    limit: number;
    total: number;
    totalPages: number;
  };
}